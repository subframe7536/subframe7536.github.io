---
alias: 计组-指令系统
tag:
- 829
date: 2022年05月16日
---
![[大纲#指令系统|大纲]]
## 指令格式
操作码字段+地址码字段
### 基本格式
#### 零地址指令
OP
1. 不需要操作数的指令，如空操作指令、停机指令、关中断指令等
2. 零地址的运算类指令仅用在堆栈计算机中。通常参与运算的两个操作数隐含地从栈顶和次栈顶弹出，送到运算器进行运算，运算结果再**隐含地压入堆栈**
#### 一地址指令
OP+A1
- 只有目的操作数的单操作数指令，按A1地址读取操作数，进行OP操作后，结果存回原地址
	- 指令含义: OP(A1)->A1，如操作码含义是加1、减1、求反、求补等
- 隐含约定目的地址的双操作数指令，按指令地址A1可读取源操作数，指令可隐含约定另一个操作数由ACC(累加器)提供，运算结果也将存放在ACC中
- 若指令字长为32位，操作码占8位，1个地址码字段占24位，则指令操作数的直接寻址范围为2^24=16M
#### 二地指令
OP+A1+A2
- 指令含义：(A1)OP(A2)->A1
- 对于常用的算术和逻辑运算指令，往往要求使用两个操作数，需分别给出目的操作数和源操作数的地址，其中目的操作数地址还用于保存本次的运算结果
- 若指令字长为32位，操作码占8位，2个地址码字段各占12位，则指令操作数的直接寻址范围为2^12=4K
#### 三地址指令
OP+A1+A2+A3(结果)
- 指令含义：(A1)OP(A2)->A3
- 若指令字长为32位，操作码占8位，3个地址码字段各占8位，则指令操作数的直接寻址范围为2^8=256
- 若地址均为主存地址，则完成一条三地址指令许哟啊访问四次存储器
	- 取指令1次
	- 区2个操作数2次
	- 存放结果1次
#### 四地址指令
OP+A1+A2+A3(结果)+A4(下址)
- 指令含义：(A1)OP(A2)->A3，A4->下一条指令的地址
- 若指令字长为32位，操作码占8位，4个地址码字段各占6位，则指令操作数的直接寻址范围为`2^6=64`
### 定长操作码
`n`为操作码表示`2^n`条指令
#### 优点
简化硬件设计，提高译码和识别速度
#### 缺点
指令数量增加会占用更多的固定位，表示操作数地址的位数受限
### 扩展操作码指令
- 短编码不能是长编码的前缀
	- 哈夫曼编码
- 不能重复
#### 扩展操作码指令分配
地址长度为`n`，上一层留出`m`种状态，下一层扩展出`m*2^n`
#### 优点
指令字长有限的情况下可以设计丰富的指令类型
#### 缺点
增加硬件复杂性，增加指令译码和识别的难度
## 寻址
分为指令寻址和数据寻址
PC(Program Counter)程序计数器，存放下一个指令的地址
EA(effective address)有效地址，存放指令的真实地址
### 指令寻址
#### 顺序寻址
PC每次加固定的值
#### 跳跃寻址
PC值根据转移类指令的内容(偏移量)改变
### 数据寻址
#### 立即寻址
在指令中直接给出操作数本身，这种操作数称为立即数
- 标志为`#`
#### 直接寻址
指令中给出的地址码是操作数的有效地址，这种地址称为直接地址或绝对地址
#### 间接寻址
指令中给出的地址码是存放操作数有效地址的主存单元地址
- OP+间接地址，标志为`@`
- 用于多个方法调用
#### 寄存器(直接)寻址
指令中给出的地址码是操作数所在的寄存器编号，操作数在寄存器中
- 寄存器数量远小于内存单元数，故寄存器编号比存储地址短，因而寄存器寻址方式的指令较短
- 操作数已在CPU中，不用访存，因而指令执行速度快
#### 寄存器间接寻址
指令中给出的地址码是一个寄存器编号，该寄存器中存放的是操作数的有效地址
#### 变址寻址
形式地址A不变，通过IX的改变获取指令地址
- 基准地址为**程序决定的地址**
- 相对于基准地址的偏移量在指令中明显或隐含地由变址寄存器I给出
- 即操作数的有效地址`EA=(IX)+A`，其中(IX)表示变址寄存器IX中的内容
##### 用途
对线性表之类的数组元素进行方便的访问，可以由用户通过程序操作
#### 相对寻址
指令操作数的有效地址或转移目标地址位于该指令所在位置的前、后某个固定位置
- 基准地址为**PC所指地址**
- 指令中的地址码字段A给出一个偏移量
- 操作数有效地址或转移目标地址`EA=(PC)+A`，偏移量A为形式地址，是一个带符号整数(补码)
##### 用途
实现公共子程序**在程序内部**的浮动或实现相对转移
##### 注意
取出当前指令后，PC会指向下一条指令，相对寻址是相对于下一条指令的偏移
#### 基址寻址
指令中的地址码字段A给出一个偏移量，基址寄存器BR明显或隐含地给出基准地址
如果没有BR，则存放在通用寄存器
- 基准地址为**程序起始的存放地址**
- 操作数有效地址`EA=(BR)+A`
##### 用途
为逻辑地址到物理地址变换提供了支持，用以实现程序的动态重定位，方便实现多道程序并发运行
#### 隐含寻址
不明显给出操作数地址或变址寄存器和基址寄存器编号，而是由操作码隐含指出
- 一地址指令中只给出一个操作数地址，另一个操作数隐含规定为累加器中的内容
#### 堆栈寻址
操作数隐含为栈顶元素，指令中无须明显指出操作数地址
堆栈寄存器SP(Stack Pointer)
## CISC&RISC
| 对比项目       | CISC                       | RISC                             |
|:-------------- |:-------------------------- |:-------------------------------- |
| 指令系统       | 复杂庞大                   | 简单精简                         |
| 指令数目       | 一般大于200条              | 一般小于100条                    |
| 指令字长       | 不固定                     | 定长                             |
| 可访存指令     | 不加限制                   | 只有LOAD/STORE指令               |
| 各指令执行时间 | 相差大                     | 绝大多数在一个周期内完成         |
| 各指令使用频率 | 相差大                     | 比较接近                         |
| 通用寄存器数量 | 少                         | 多                               |
| 目标代码       | 难以优化编译，较为低效     | 采用优化编译，较为搞笑           |
| 控制方式       | 大多数为微程序控制，效率较高 | 大多数采用组合逻辑控制，效率较低 |
| 指令流水线     | 非必须，可通过一定方式实现 | 必须实现                         |
