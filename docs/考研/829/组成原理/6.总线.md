---
alias: 计组-总线
tag:
- 考研
- 829
- 计组
date: 2022年05月22日
---
![[大纲#系统总线]]
## 基本概念
一组能为多个部件分时共享的公共信息传输线路
### 特点
- **共享**是指总线上可以挂接多个部件，各个部件之间互相交换的信息都可以通过这组线路分时共享。
- **分时**是指同一时刻只允许有一个部件向总线发送信息，如果系统中有多个部件，则它们只能分时地向总线发送信息。
### 特性
- 机械特性：尺寸、形状、管脚数、排列顺序
- 电气特性：传输方向和有效的电平范围
- 功能特性：每根传输线的功能（地址、数据、控制）
- 时间特性：信号的时序关系
## 分类
### 按数据传输格式
#### 串行总线
一位一位的发，经过总线，一位一位的接收
##### 优点
- 只需要一条传输线，成本低廉，广泛应用于长距离传输
- 在计算机内部可以节省布线空间
##### 缺点
在数据发送和接收的时候要进行拆卸和装配，要考虑**串行-并行转换**的问题
#### 并行总线
所有数据同时放到总线，同时传输，同时接收  
##### 优点
总线的逻辑时序比较简单，电路实现起来比较容易
##### 缺点
- 信号线数量多，占用更多的布线
- 空间距离远传输成本高昂
- 由于工作频率较高时，并行的信号线之间会产生严重干扰，对每条线等长的要求也越高，所以无法持续提升工作频率
### 按功能
#### 片内总线
位于芯片内部，寄存器之间、寄存器与ALU之间连接
#### 系统总线
各功能部件（CPU、主存、IO接口）之间连接
##### 数据总线DB
传输各功能部件之间的数据信息
- 双向传输
- 位数与机器字长、存储字长有关
- **数据通路**是各个部件通过数据总线连接后形成的数据传输路径
##### 地址总线AB
指出数据总线上的源数据或目的数据所在的主存单元或I/O端口的地址
- 单向传输
- 位数与主存地址空间的大小有关
##### 控制总线CB
传输控制信息，包括CPU送出的控制命令和主存（或外设）返回CPU的反馈信号
#### 通信总线
又称外部总线，设备之间连接
### 按时序控制
同步总线、异步总线
## 系统总线结构
### 单总线结构
![[Pasted image 20220522160325.png]]
CPU、主存、I/O设备（通过I/O接口）都连接在一组总线上，允许I/O设备之间、I/O设备和CPU之间或I/O设备与主存之间直接交换信息
- 单总线并不是指只有一根信号线
#### 优点
结构简单，成本低，易于接入新的设备
#### 缺点
带宽低、负载重，多个部件只能争用唯一的总线，且不支持并行发送数据
### 双总线结构
![[Pasted image 20220522160712.png]]
有两条总线，一条是主存总线 ，用于CPU、主存和通道之间进行数据传送；另一条是`I/O`总线 ，用于多个外部设备与通道之间进行数据传送。
- 主存总线：支持突发（猝发）传送：送出一个地址，收到多个地址连续的数据
- 通道：具有特殊功能的处理器，能对`I/O`设备进行统一管理，通道程序放在主存中
#### 优点
将较低速的`I/O`设备从单总线上分离出来，实现存储器总线和`I/O`总线分离
#### 缺点
需要增加通道等硬件设备
### 三总线结构
![[Pasted image 20220522160958.png]]
采用3条各自独立的总线来构成信息通路，分别为主存总线、`I/O`总线和直接内存访问DMA总线
#### 优点
通过DMA提高了`I/O`相对高速的设备的性能，提高响应速度和系统吞吐量
#### 缺点
系统工作效率较低（同一总线只有一个能用）
## 性能指标
### 总线的传输周期(总线周期)
一次总线操作所需的时间(申请(+仲裁)->寻址->传输->结束)，通常由若干个总线时钟周期组成
### 总线时钟周期  
机器的时钟周期，用于控制所有部件(包括总线)
#### 注意
- 大多数情况下，一个总线周期包含多个总线时钟周期
- 有的时候，一个总线周期就是一个总线时钟周期
- 有的时候，一个总线时钟周期可包含多个总线周期
### 总线的工作频率
总线周期的倒数，指一秒传送几次数据
### 总线的时钟频率
时钟周期的倒数，指一秒多少个时钟周期
### 总线宽度  
总线位宽，指同时传输数据的位数，单位bit
### 总线带宽
每秒总线可传输数据的位数，单位B/s
- 总线带宽 = 总线工作频率 * 总线宽度 / 8 = 总线宽度 / 8 / 总线周期
### 总线复用
多路在同一总线传输，通过分时控制
- 一般时地址和数据总线共用
### 信号线数
地址、数据、控制总线的线的总数
## 总线仲裁
解决多个设备共用总线
### 集中仲裁
1. 主设备发出请求信号
2. 若多个设备同时使用，由总线控制器判优和仲裁确定优先级
3. 获得使用权的主设备开始传输设备
#### 链式查询
![[Pasted image 20220528171408.png]]
BG串行响应请求信号，遇到请求的接口时，传递信号并将BS置为 忙 状态，此时可以进行传输数据；当传输完毕后，BS置为 空 状态，BG继续往后走
- 离总线越近，优先级越高
##### 优点
结构简单，扩充容易
##### 缺点
- 电路故障敏感性高
- 执行优先级无法改变
#### 计数器定时查询
![[Pasted image 20220528194249.png]]
多了一组设备地址线，少了一根总线响应线BG，通过计数器设置开始询问接口id，做到动态设置
##### 优点
- 可以由程序控制计数器的初值
- 对电路故障没有链式敏感
##### 缺点
- 控制线数量增加(logn条)
- 控制实现相对复杂
#### 独立请求
![[Pasted image 20220528195338.png]]
控制部件由选择器(队列)进行控制，每个设备都有一对总线请求线BR和总线允许线BG
##### 优点
- 响应速度快，可以直接和控制部件传输信息
- 优先顺序控制灵活
##### 缺点
- 控制线数量多(2n+1条)
- 控制实现更复杂
### 分布仲裁(考的少)
不需要中央仲裁器，都有自己的仲裁器和仲裁号
- 当设备有总线请求时，它们就把各自唯一的仲裁号发送到共享的仲裁总线上
- 每个仲裁器将从仲裁总线上得到的仲裁号与自己的仲裁号进行比较
- 如果仲裁总线上的号优先级高，则它的总线请求不予响应，并撤销它的仲裁号
- 最后，获胜者的仲裁号保留在仲裁总线上。
## 操作和定时
交换数据的过程中对时间的控制，是一种协议或规则
### 同步通信(定时)
同步定时方式是指系统采用**统一的时钟信号**来协调发送和接收双方的传送定时关系。若干个时钟产生相等的时间间隔，每个间隔构成一个总线周期。在一个总线周期中，发送方和接收方可进行一次数据传送。因为采用统一的时钟，每个部件或设备发送或接收信息都在固定的总线传送周期中，一个总线的传送周期结束，下一个总线传送周期开始。
- 适用于**总线长度较短**及**总线所接部件存取时间接近**的系统
#### 优点
传送速度快，具有较高的传输速率;总线控制逻辑简单。
#### 缺点
主从设备属于强制性同步;不能及时进行数据通信的有效性检验，可靠性较差。
### 异步通信(定时)
在异步定时方式中，**没有统一的时钟**，也没有固定的时间间隔，完全依靠传送双方相互制约的“握手”信号来实现定时控制。通常，把交换信息的两个部件或设备分为主设备和从设备，主设备提出交换信息的“请求”信号，经接口传送到从设备；从设备接到主设备的请求后，通过接口向主设备发出“回答”信号。
#### 不互锁
主从设备**都不设置**接收到信号才撤销请求
#### 半互锁
主设备**设置**接收到信号才撤销请求，从设备**不设置**接收到信号才撤销请求
#### 全互锁
主从设备**都设置**接收到信号才撤销请求
- 最可靠但最慢
#### 优点
总线周期长度可变，能保证两个工作速度相差很大的部件或设备之间可靠地进行信息交换，自动适应时间的配合。
#### 缺点
控制方式较复杂，速度比同步慢
### 半同步通信
统一时钟的基础上，增加一个等待响应信号WAIT
- 同步：发送方用系统时钟前沿发信号，接收方用系统时钟后沿判断、识别
- 异步：允许不同速度的模块和谐工作
### 分离式通讯
#### 优化方式
上述三种共同点：先由主模块发出地址和命令，从模块收到信号后开始准备数据，准备完再传输。在该过程中，从模块准备数据**不需要使用主线**，但主线仍然占着，即可以优化
#### 实现方式
传输周期分为两个
- 第一个周期：主模块申请占用主线，使用完立刻放弃占用
- 第二个周期：从模块申请占用主线，将信息传输给主模块
#### 优点
- 准备数据时不需要占用总线，利用率提高
- 各模块均有权占用总线，而且不用等待对方回答
## 标准
| 名称    | 类型               | 作用                                                 |
| ------- | ------------------ | ---------------------------------------------------- |
| ISA     | 系统总线           | 最早出现的系统总线                                   |
| EISA    | 系统总线           | ISA的扩展                                            |
| VESA    | 局部总线           | 用于PC多媒体传输                                     |
| PCI     | 局部总线、并行总线 | 局部总线，连接显卡、声卡、网卡等高度集成的外围部件   |
| PCI-E   | 局部总线           | PCI+AGP(视频接口)的集合和扩展                        |
| RS-232C | 串行总线           | 串行通信总线，用于终端设备和通信设备的连接           |
| USB     | 串行总线           | 用于IO，设备总线                                     |
| PCMCIA  |                    | 笔记本接口                                           |
| IDE     |                    | 磁盘驱动器接口                                       |
| SCSI    |                    | 计算机和智能设备(硬盘、光驱、软驱、打印机)的接口标准 |
| SATA    |                    | 串行硬件驱动器接口                                   |
